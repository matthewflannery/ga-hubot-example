# ga-hubot-example

ga-hubot-example is a chat bot built on the [Hubot][hubot] framework. It was
initially generated by [generator-hubot][generator-hubot], and configured to be
deployed on [Heroku][heroku] to get you up and running as quick as possible.

[heroku]: http://www.heroku.com
[hubot]: http://hubot.github.com
[generator-hubot]: https://github.com/github/generator-hubot


### Prerequisites

This assumes you have the [Heroku toolbelt][heroku-toolbelt] and [Have a Heroku account][heroku]

[heroku-toolbelt]: https://toolbelt.heroku.com/
[heroku]: http://www.heroku.com

### Installation

Simply clone this git repository, login to Heroku, create a new application, push your code base and deploy. Deployment instructions are as per below, and also instructions for testing locally are provided.

Login to Heroku
`heroku login`

Create a new application on Heroku
`heroku create myhubotappnamehere`

Connect your local repository to Heroku
`git remote add heroku https://git.heroku.com/myhubotappnamehere`

Obtain Slack token by browsing to https://my.slack.com/services/new/hubot - ensure that you are signed into the correct team, fill out the relevant details and note down your key for the next step.

Add the following configs for Slack

`heroku config:add HEROKU_URL=https://myhubotapp.herokuapp.com`
`heroku config:add HUBOT_SLACK_TOKEN=YourTokenGoesHere`

Deploy your codebase to your newly created Heroku application
`git push heroku master`

Enable your Heroku Slackbot application with the following
`heroku ps:scale web:1`

### Testing locally

To test your Hubot Slackbot application locally, simply execute the following command
`HUBOT_SLACK_TOKEN=TOKEN-GOES-HERE ./bin/hubot --adapter slack`


### Usage

This section defines scripts provided within the repository, which you can further extend or use as examples to build your own. The files are included in the /scripts/ directory within the repository root.

| Script | Location| Description|
| ------ | ------ | ------ |
| interactions | [scripts/interactions.js](scripts/interactions.js) | Chat features, respond to various user input
| threatcrowdApi | [scripts/threatcrowdApi.js](scripts/threatcrowdApi.js) | Leverages the Threatcrowd API (threatcrowd.org) to perform DNS reconnaissance against a target
| resolve | [scripts/resolve.js](scripts/resolve.js) | Simple script to resolve a DNS name, and persist the result to a Redis K/V store.

##### threatcrowdApi.js
Simple Hubot script that performs a lookup against the Threatcrowd API for a user supplied target domain as input, and returns the results. further improvement would be to automate the script to run at an interval, persist retrieved information to an SQL DB, analyse if the new domain record has been persisted previously and send a Push / Slack notification if a new domain record has been found.

**Usage**
`threatcrowd domain.com`

##### resolve.js

Simple script to resolve a DNS name, and store the result in Hubots built in K/V store.

**Usage**
`@BOTNAME resolve domain.com`


##### interactions.js

This script provides basic chat features to interact with user input, returning a different response based on the input. The code is well documented, but as a brief overview:

**Ask the bot if GA class is on today**
There is a conditional outcome based on user input leveraging RegEx to be somewhat intelligent in replies. As an example, "do we have class today" or "are we going to class today" - will give the replies:
``"Indeed, we have class today"`` or ``"Indeed, going to class today"``
This could be further extended with or else if conditions to satisfy non matching regex or even additinal regex conditions such as `is class today`, which won't give a reply, but you get the general idea.

**Make a statement when a user joins / leaves**
When a user enters, either of one "Hello" || "Target acquired" || "ohai" will be sent to the channel.
When a user leaves, either one of "RIP" || "kthxbye" || "lat@@@@" will be sent to the channel.

**Mention a user**
Uses the respond method to send a mention to a user in the channel.
`@BOTNAME mtn USERNAME hello from Hubot!`


**Receive a sarcastic reply about nuclear warfare**
`NAMEbot launch the nukes`
Returns "Now we are talking! Launching the nukes!""
`NAMEbot can you not launch the nukes || please not launch the nuclear weapons || for the love of god, whatever you do, do not launch the nukes`
Returns "Roger that. Lauching nuclear weapons."
`NAMEbot can you $ANYTHINGELSE`
Returns I do not know how to $ANYTHINGELSE, i'm a nuclear warfare robot! Stop being silly
